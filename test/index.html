<html>
<head>
	<title>StudioKit Caliper JS Test</title>
</head>
<body>
	<h1>StudioKit Caliper JS Test</h1>
	<script src="../dist/studiokit-caliper.js"></script>
	<script>

		var sensorId =  "https://app.example.edu/sensor";
		var sensorOptions = {
			protocol: 'http:',
			hostname: 'localhost',
			port: '3001',
			path: '/collector',
			method: 'POST'
		};

		var token = {
			accessToken: 'THIS_IS_NOT_A_REAL_ACCESS_TOKEN', //response.data['access_token'],
			expires: 'Thu, 09 Feb 2017 06:08:58 GMT' //response.data['.expires']
		};

		// e.g. fetch (React), $http.get() (Angular 1)
		var getToken = function() {
			return new Promise(function(resolve, reject){
				resolve(token);
			});
		};

		// e.g. localStorage
		var store = {};
		var storageService = {
			getItem: function(key) {
				return store[key];
			},
			setItem: function(key, value) {
				store[key] = value;
			},
			removeItem: function(key) {
				delete store[key]
			}
		};

		var options = {
			sensorId: sensorId,
			sensorOptions: sensorOptions,
			appId: 'https://app.example.edu',
			appName: 'Example App',
			getToken: getToken,
			storageService: storageService
		};

		var caliperService = new StudioKit.CaliperService(options);
		caliperService.setPerson('https://example.edu/user/1', 'Some', 'Guy');
		caliperService.startSession();
		setTimeout(function() {
			caliperService.endSession();
			caliperService.send()
				.catch(function(err) {
					console.error('error', err);
				})
				.then(function(result) {
					console.log('success', result);
				});
		}, 1000 * 60 * 60);

	</script>
</body>
</html>
